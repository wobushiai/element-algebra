# 第十六章：椭圆曲线 —— 几何与数论的桥梁

> **本章导读**：椭圆曲线是代数几何与数论交叉的核心对象。它们是亏格为 1 的光滑曲线，带有自然的阿贝尔群结构。椭圆曲线在密码学、模形式和费马大定理中扮演着关键角色。

---

## 16.1 椭圆曲线的定义

### 16.1.1 定义

> **定义 16.1.1（椭圆曲线）**
> 
> **椭圆曲线** E 是：
> 1. 光滑的
> 2. 亏格 g = 1
> 3. 带有一个指定基点 O（单位元）
> 
> 的代数曲线。

```text
典型方程（Weierstrass 形式）：
y² + a₁xyz + a₃yz² = x³ + a₂x²z + a₄xz² + a₆z³

简化（在特征 ≠ 2, 3 的域中）：
y² = x³ + ax + b
其中判别式 Δ = -16(4a³ + 27b²) ≠ 0
```

### 16.1.2 判别式与不变量

> **定义 16.1.2（判别式）**
> 
> 对于 Weierstrass 方程 y² = x³ + ax + b，**判别式** Δ 和 **j-不变量**定义为：
> 
> ```
> Δ = -16(4a³ + 27b²)
> j = -1728(4a)³/Δ
> ```
> 
> 光滑条件 ⇔ Δ ≠ 0。

```text
例子：
- 曲线 y² = x³ + x：a = 1, b = 0, Δ = -64, j = 1728
- 曲线 y² = x³ + 1：a = 0, b = 1, Δ = -432, j = 0

j-不变量完全分类了椭圆曲线（在同构意义下）！
```

---

## 16.2 群结构

### 16.2.1 几何加法

> **定义 16.2.1（椭圆曲线上的加法）**
> 
> 在椭圆曲线 E 上，定义加法如下：
> - P + O = P（O 是单位元）
> - P + (-P) = O（逆元）
> - P + Q + R = O 当且仅当 P, Q, R 共线

```text
几何构造：
1. 连接 P 和 Q 的直线
2. 找到与 E 的第三个交点 R'
3. 连接 R' 和 O 的直线
4. 与 E 的第三个交点就是 -(P+Q)
5. 所以 P + Q = -R'
```

### 16.2.2 群的代数公式

> **公式 16.2.2（加法公式）**
> 
> 给定 P = (x₁, y₁), Q = (x₂, y₂)：
> 
> 若 P ≠ ±Q：
> - λ = (y₂ - y₁)/(x₂ - x₁)
> - x₃ = λ² - x₁ - x₂
> - y₃ = -y₁ + λ(x₁ - x₃)
> 
> 若 P = Q（倍点）：
> - λ = (3x₁² + a)/(2y₁)
> - x₃ = λ² - 2x₁
> - y₃ = -y₁ + λ(x₁ - x₃)

---

## 16.3 椭圆曲线的模

### 16.3.1 椭圆曲线上的模

> **定义 16.3.1（椭圆曲线上的模层）**
> 
> 对椭圆曲线 E：
> - O(E)：结构层
> - O(dP)：d 次除子对应的可逆层
> - Ω¹：微分模层

```text
重要事实：
- H⁰(E, O(dP)) = d（当 d > 0）
- H⁰(E, Ω¹) = 1
- 典范层 Ω¹ 是平凡的（g = 1）！
```

### 16.3.2 截面

> **计算 16.3.2（截面数）**
> 
> 对 d ≥ 0：
> 
> ```
> dim H⁰(E, O(dP)) = d
> ```

---

## 16.4 复椭圆曲线

### 16.4.1 复数上的椭圆曲线

> **定义 16.4.1（复椭圆曲线）**
> 
> 复数域 ℂ 上的椭圆曲线对应于复环面：
> 
> ```
> E(ℂ) ≅ ℂ/Λ
> ```
> 
> 其中 Λ = ℤω₁ + ℤω₂ 是格子（lattice）。

```text
例子：
- Λ = ℤ + ℤi → 椭圆曲线 y² = x³ + x（j = 1728）
- Λ = ℤ + ℤω（ω = e^{2πi/3}）→ 椭圆曲线 y² = x³ + 1（j = 0）
```

### 16.4.2 复乘

> **定义 16.4.2（复乘）**
> 
> 如果格 Λ 在乘以某个复数 α 下不变，则称 E 有**复乘**（CM）。

```text
例子：
- 虚二次域 Q(√-1) 对应 j = 1728
- 虚二次域 Q(√-3) 对应 j = 0
```

---

## 16.5 有限域上的椭圆曲线

### 16.5.1 有限域曲线

> **定义 16.5.1（F_q 上的椭圆曲线）**
> 
> 在有限域 𝔽_q 上的椭圆曲线：
> 
> ```
> E: y² = x³ + ax + b (a, b ∈ 𝔽_q)
> ```
> 
> 其中判别式 Δ ≠ 0。

```text
重要不变量：
- #E(𝔽_q)：𝔽_q 上点的个数
- Hasse-Weil 定理：
  |#E(𝔽_q) - (q + 1)| ≤ 2√q
```

### 16.5.2 点数计算

> **计算 16.5.2（点数的计算方法）**
> 
> 步骤：
> 1. 对每个 x ∈ 𝔽_q，检查 x³ + ax + b 是否是平方
> 2. 如果是，有两个解（y 和 -y）
> 3. 如果不是，没有解
> 4. 加上无穷远点 O

---

## 16.6 椭圆曲线在密码学中的应用

### 16.6.1 椭圆曲线密码学（ECC）

> **定义 16.6.1（椭圆曲线离散对数问题）**
> 
> 椭圆曲线密码学基于以下问题：
> 
> 给定 P 和 Q = nP，求 n 是困难的。

```text
优势：
- 密钥长度短（相比 RSA）
- 效率高
- 安全性好

常用曲线：
- P-256
- Curve25519
```

### 16.6.2 密钥交换

> **协议 16.6.2（ECDH）**
> 
> 椭圆曲线 Diffie-Hellman 密钥交换：
> 1. Alice 选择私钥 n_A，计算 P_A = n_A·G
> 2. Bob 选择私钥 n_B，计算 P_B = n_B·G
> 3. 交换公钥
> 4. 共享秘密 = n_A·P_B = n_B·P_A

---

## 16.7 椭圆曲线与数论

### 16.7.1 BSD 猜想

> **Conjecture 16.7.1（Birch and Swinnerton-Dyer）**
> 
> 对椭圆曲线 E/ℚ：
> 
> ```
> L(E, s) 在 s = 1 处的阶 = rank(E)
> ```
> 
> 其中 L(E, s) 是 L-函数。

```text
意义：
- 连接了分析（E 的 L-函数）
- 和代数（E 的有理点群）
- 已被证明对很多曲线成立！
```

### 16.7.2 费马大定理

> **定理 16.7.2（Wiles 等）**
> 
> 费马大定理：xⁿ + yⁿ = zⁿ 对 n ≥ 3 无正整数解。
> 
> 证明关键使用了**椭圆曲线模性**：
> - 每个椭圆曲线/ℚ 是模的
> - 某些椭圆曲线的存在会导致矛盾

---

## 16.8 模椭圆曲线

### 16.8.1 模曲线 Y(1)

> **定义 16.8.1（模曲线）**
> 
> **Y(1)** = j-平面上去掉尖点的开集：
> 
> ```
> Y(1) = {j(E) | E 椭圆曲线} ≅ A¹
> ```

### 16.8.2 紧化

> **定义 16.8.2（紧化 X(1)）**
> 
> 添加尖点（cusp）：
> 
> ```
> X(1) = Y(1) ∪ {尖点}
> ```

---

## 16.9 习题

### 基础题

1. 验证：曲线 y² = x³ + x 的判别式

2. 计算：P + P 在椭圆曲线上的公式

3. 列出：𝔽₅ 上椭圆曲线 y² = x³ + x 的点

### 进阶题

4. 证明：椭圆曲线的点构成阿贝尔群

5. 计算：复椭圆曲线 ℂ/(ℤ + ℤi) 的 j-不变量

6. 描述：椭圆曲线密码学的基本原理

### 挑战题

7. **探索**：
   - 阅读 BSD 猜想
   - 思考：为什么这个问题重要？

---

## 本章小结

| 概念 | 定义 | 例子 |
|------|------|------|
| 椭圆曲线 | g=1，带基点的光滑曲线 | y²=x³+ax+b |
| 判别式 | Δ = -16(4a³+27b²) | ≠ 0 确保光滑 |
| j-不变量 | j = -1728(4a)³/Δ | 分类椭圆曲线 |
| 群结构 | P+Q+R=0 当共线 | 曲线上的加法 |
| 复椭圆曲线 | ℂ/Λ | 复环面 |
| 有限域点 | #E(𝔽_q) | Hasse-Weil 界 |
| 密码学 | ECDH, ECDSA | 离散对数 |

---

## 下一步

这已经是相当完整的基础内容了！后续可以探索：
- Abel 簇理论
- 模形式
- 算术几何

---

*练习答案见附录*

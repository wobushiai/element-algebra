# 第十一章：仿射概形 —— 从簇到概形的飞跃

> **本章导读**：仿射概形是现代代数几何的基本 building block。从「坐标环的几何」升级到「任意交换环的谱」，概形理论让我们能够研究更「病态」的对象——但这反而让理论更强大、更灵活。这一章会非常详细地介绍概形的定义。

---

## 11.1 动机：从仿射簇到概形

### 11.1.1 仿射簇的局限

仿射簇理论很好，但它有一些局限：

1. **闭点问题**：在仿射簇中，不是每个点都是「闭点」
2. **非约化结构**：仿射簇总是自动是约化的（没有幂零元）
3. **参数化能力有限**：很多自然的代数对象不是仿射簇

### 11.1.2 解决方案：概形

> **核心思想**：与其研究「坐标环的几何」，不如研究「环本身的几何」！

> **定义 11.1.1（概形的思想）**
> 
> 把「点」重新定义为「环的素理想」：
> - 点 p ⇔ 素理想 p
> - 点的「邻近结构」⇔ 局部环 O_{X,p} = R_p

---

## 11.2 素理想与谱

### 11.2.1 素理想回顾

> **定义 11.2.1（素理想）**
> 
> 环 R 中的**素理想（Prime Ideal）** p 满足：
> 1. p ≠ R
> 2. 若 ab ∈ p，则 a ∈ p 或 b ∈ p

```text
例子：
- 在 ℤ 中，⟨p⟩（p 为素数）是素理想
- ⟨0⟩ 在整环中是素理想
- 在 ℤ₆ = ℤ/6ℤ 中，⟨2⟩ 和 ⟨3⟩ 是素理想吗？
  - ℤ₆/⟨2⟩ ≅ ℤ₂（是域）→ ⟨2⟩ 是素理想
  - ℤ₆/⟨3⟩ ≅ ℤ₃（是域）→ ⟨3⟩ 是素理想
```

### 11.2.2 谱的定义

> **定义 11.2.2（环的谱）**
> 
> 环 R 的**谱（Spectrum）** 记作 **Spec(R)**，定义为：
> 
> ```
> Spec(R) = {R 的所有素理想 p}
> ```

```text
例子：
- Spec(ℤ) = {⟨0⟩, ⟨2⟩, ⟨3⟩, ⟨5⟩, ...}
- Spec(k[x]) = {⟨0⟩, ⟨x-a⟩, 不可约多项式生成的理想, ...}
- Spec(k) = {⟨0⟩}（只有一个点的「仿射线」！）

几何直觉：
- 「闭点」= 极大理想（如 ⟨x-a⟩）
- 「泛点」= 零理想 ⟨0⟩（在整环中）
```

### 11.2.3 谱的拓扑

> **定义 11.2.3（Zariski 拓扑在 Spec R 上）**
> 
> 对每个理想 I ⊆ R，定义：
> 
> ```
> V(I) = {p ∈ Spec(R) | I ⊆ p}
> ```
> 
> 这些 V(I) 构成 Zariski 闭集。

```text
例子：
- V(⟨f⟩) = {p | f ∈ p} = 「f 在 p 处为零」
- V(⟨0⟩) = Spec(R)（全集）
- V(⟨1⟩) = ∅（空集）

这就是「用多项式定义闭集」的一般化！
```

---

## 11.3 仿射概形的定义

### 11.3.1 局部环

> **定义 11.3.1（局部环）**
> 
> **局部环（Local Ring）** 是只有一个极大理想的环。

```text
例子：
- k[x]₍ₓ₎ = 在 x 处的有理函数环
  - 元素 = f(x)/g(x)，其中 g(0) ≠ 0
  - 极大理想 = ⟨x⟩（所有在 0 处为零的函数）
  
- R_p = 在素理想 p 处的局部化
  - 元素 = r/s，其中 s ∉ p
  - 极大理想 = pR_p
```

### 11.3.2 仿射概形

> **定义 11.3.2（仿射概形）**
> 
> **仿射概形（Affine Scheme）** 是一个配对 (X, O_X)，其中：
> 1. X = Spec(R) 是拓扑空间（素理想的集合）
> 2. O_X 是 X 上的层（结构层），定义为：
>    - 对主开集 D(f) = {p | f ∉ p}，O_X(D(f)) = R_f
>    - （局部化后的环）

```text
简而言之：
仿射概形 = 环 R 的「几何化」

记号：Spec(R) 或简写为 Spec R
```

### 11.3.3 结构层的直观理解

> **结构层 O_X 的定义（详细版）**
> 
> 对每个开集 U ⊆ Spec(R)，O_X(U) 是在 U 的每点附近「有良好定义」的元素的集合。

对**主开集** D(f) = {p ∈ Spec(R) | f ∉ p}：
```
O_X(D(f)) = R_f = {a/fⁿ | a ∈ R, n ≥ 0}
```
即「分母可以是 f 的幂」的局部化。

```text
例子：
- 在 Spec ℤ 中：
  - D(2) = {ℤ 的所有不包含 2 的素理想}
  - O(D(2)) = ℤ_2 = {a/2ⁿ | a ∈ ℤ}
```

---

## 11.4 仿射概形的例子

### 11.4.1 仿射直线

> **例子 11.4.1（仿射直线）**
> 
> X = Spec(k[x])
> - 点 = k[x] 的素理想
> - 闭点 = ⟨x-a⟩（a ∈ k）
> - 非闭点（泛点）= ⟨0⟩（在 k[x] 是整环时）

```text
几何：
- Spec(k[x]) 就像「一条直线 + 一个泛点」
- 泛点 «漂浮在所有点之上»
```

### 11.4.2 仿射平面

> **例子 11.4.2（仿射平面）**
> 
> X = Spec(k[x, y])
> - 闭点 = 极大理想 ⟨x-a, y-b⟩（对应点 (a, b)）
> - 曲线上的点 = 不可约多项式生成的素理想
> - 泛点 = ⟨0⟩

```text
例子：
- 点 (1, 2) → 极大理想 ⟨x-1, y-2⟩
- 抛物线 y = x² → 素理想 ⟨y-x²⟩
- 原点 → 极大理想 ⟨x, y⟩
```

### 11.4.3 带有幂零元的环

> **例子 11.4.3（带有幂零元的概形）**
> 
> 考虑 R = k[x]/(x²) = k[ε]，其中 ε² = 0
> 
> Spec(R) 只有一个点（极大理想 ⟨ε⟩），但这个点「记住」了 ε 的信息！

```text
几何直觉：
- 作为集合，Spec k[ε] 只有一个点
- 但这个点「有非平凡的结构」——有一个「无穷小」方向
- 这在形变理论中非常重要！
```

> 💡 **关键点**：概形可以「记住」比点集更多的信息！这就是为什么概形比簇更强大。

---

## 11.5 仿射概形的态射

### 11.5.1 对应原理

> **命题 11.5.1（概形态射 ↔ 环同态）**
> 
> 仿射概形态射 Spec S → Spec R 对应于**环同态**：
> 
> ```
> Hom(Spec S, Spec R) ≅ Hom(R, S)
> ```
> 
> 其中 Hom(R, S) 是 R 到 S 的环同态（方向相反！）。

```text
例子：
- 恒等映射 ↔ 恒等同态
- 投影 Spec k[x] → Spec k[y] (x ↦ 0) ↔ 包含映射 k[y] → k[x]
- 嵌入 A¹ → A², x ↦ (x, 0) ↔ 投影 k[x,y] → k[x] (y ↦ 0)
```

### 11.5.2 基变更

> **定义 11.5.2（基变更）**
> 
> 给定态射 f: Spec S → Spec R 和 R-模 M，**基变更**是：
> 
> ```
> M ⊗_R S
> ```
> 
> 这对应于「在新的基环上」看原来的模。

---

## 11.6 模层

### 11.6.1 模层的定义

> **定义 11.6.1（O_X-模）**
> 
> 在仿射概形 X = Spec R 上，**O_X-模（Module over Structure Sheaf）** 是层 M，使得：
> - 对每个开集 U，M(U) 是 O_X(U)-模
> - 限制映射兼容模结构

```text
例子：
- 结构层 O_X 本身是 O_X-模
- 对每个理想 I ⊇ R，I 定义一个理想层 I~
- 局部化 M → M_f 给出 O_X-模
```

### 11.6.2 拟凝聚层

> **定义 11.6.2（拟凝聚层）**
> 
> **拟凝聚层（Quasi-coherent Sheaf）** 是局部由「某个模的截面」描述的层。

```text
核心事实：
在仿射概形 Spec R 上：
- 任何 O_X-模对应于一个 R-模 M
- 层 M~ 由 M 「生成」：M~(D(f)) = M_f
```

> 💡 这建立了「模 ⇔ 拟凝聚层」的双射！

---

## 11.7 局部化与茎

### 11.7.1 局部化回顾

> **定义 11.7.1（R 的局部化）**
> 
> 对乘性子集 S ⊆ R，**局部化** S⁻¹R 是：
> 
> ```
> S⁻¹R = {a/s | a ∈ R, s ∈ S} / ~ 
> ```
> 
> 其中 a/s = a'/s' ⇔ ∃t ∈ S 使得 t(sa' - s'a) = 0。

### 11.7.2 茎

> **定义 11.7.2（层的茎）**
> 
> 层 F 在点 p ∈ Spec R 的**茎** F_p 定义为：
> 
> ```
> F_p = ⨲_{p ∈ U} F(U)
> ```
> 
> 即所有包含 p 的开集上截面的「在 p 处等价」的集合。

```text
例子：在仿射概形 Spec R 上
- O_X,p = R_p（环在素理想 p 处的局部化）
- 这是局部环！
- 极大理想 = pR_p
```

---

## 11.8 仿射概形的维数

### 11.8.1 环的维数

> **定义 11.8.1（Krull 维数）**
> 
> 环 R 的**维数** dim R 是：
> 
> ```
> dim R = 素理想链 p₀ ⊂ p₁ ⊂ ... ⊂ pₙ 的最大长度 n
> ```

```text
例子：
- dim k[x₁, ..., xₙ] = n（仿射空间的维数）
- dim k[x] = 1（直线的维数）
- dim ℤ = 1（素数的「高度」）
- dim k = 0（域的维数为 0）
```

### 11.8.2 维数与几何

> **命题 11.8.2（维数的几何意义）**
> 
> 对仿射簇 V，dim V = dim k[V] = V 的 Krull 维数。

---

## 11.9 习题

### 基础题

1. 列出 Spec ℤ₈ 的所有素理想

2. 描述 Spec(k[x]/(x²)) 的结构

3. 验证：O_X(D(f)) ≅ R_f

### 进阶题

4. 证明：仿射概形态射对应于环同态的反向映射

5. 描述：如何用理想层定义子概形

6. 计算：Spec(k[x, y]/(xy)) 的维数

### 挑战题

7. **探索**：
   - 阅读「几何实现」：如何把仿射簇实现为仿射概形？
   - 思考：仿射簇和仿射概形有什么本质区别？

---

## 本章小结

| 概念 | 定义 | 例子 |
|------|------|------|
| 谱 Spec(R) | 环 R 的素理想集合 | Spec ℤ, Spec k[x] |
| 仿射概形 | (Spec R, O_R) | Spec k[x], Spec k[x,y] |
| 结构层 | O_X(D(f)) = R_f | 主开集上的局部化 |
| 局部环 | 只有一个极大理想的环 | R_p |
| 态射 ↔ 同态 | Hom(Spec S, Spec R) ≅ Hom(R,S) | 环同态给出态射 |
| O_X-模 | 结构层上的模 | 理想层、截面层 |
| 拟凝聚层 | 局部由模截面定义的层 | 任何 O_X-模在仿射情况下 |
| Krull 维数 | 素理想链的最大长度 | dim k[x₁,...,xₙ] = n |

---

## 代数几何伏笔

> 这一章学的仿射概形，是现代代数几何的基础！
> 
> - **概形** = 局部同构于仿射概形的局部环空间
> - **簇** = 有限型概形
> - **模层** = 概形上的「向量丛」
> - **导出范畴** = 层的「最优」范畴
> 
> 下一章我们将学习**概形理论**——从仿射到一般的概形！

---

## 下一步

下一章我们将学习**概形理论**——如何把仿射概形「粘」成一般的概形！

准备好了吗？🚀

---

*练习答案见附录*

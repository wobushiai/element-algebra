# 第十四章：层上同调 —— 整体与局部的桥梁

> **本章导读**：层上同调是研究代数几何整体性质的核心工具。从「局部信息」到「整体信息」的跨越，需要上同调来测量「障碍」。这一章会非常详细地介绍上同调的概念、计算方法，以及它在代数几何中的应用。

---

## 14.1 动机：为什么要上同调？

### 14.1.1 从局部到整体的困难（详细解释）

**问题：局部能做到的事情，整体能做到吗？**

在微分几何中，我们知道：
- 局部有光滑函数
- 但整体是否有光滑函数？不一定！

```text
例子：球面 S²
- 局部：任何点附近都有光滑函数
- 整体：存在非常数光滑函数吗？有的！

但考虑：
- 球面 S² 上的光滑函数层 O
- H⁰(S², O) = 常数函数（因为最大值原理）
```

**更严重的问题：能否粘起来？**

```text
例子：单位圆上的非平凡线丛
- 局部：每点附近都有「1-form」
- 整体：是否存在整体截面？
- 答案：没有（非平凡拓扑障碍）
```

### 14.1.2 上同调解决什么问题？

> **核心思想**：上同调测量的是「局部信息无法整合成整体信息」的障碍程度！

> **定义 14.1.1（上同调的基本思想）**
> 
> - **H⁰(X, F)** = 整体截面（可以直接「看到」的截面）
> - **H¹(X, F)** = 把局部截面「粘」成整体的障碍
> - **H²(X, F)** = 把「粘好的截面」再粘的障碍
> - ...

---

## 14.2 预层的上同调

### 14.2.1 预层的截面

> **定义 14.2.1（预层的整体截面）**
> 
> 对预层 F，**整体截面**定义为：
> 
> ```
> Γ(X, F) = F(X)
> ```
> 
> 即最大的开集（整个空间）上的截面。

```text
例子：
- 对连续函数层 C：Γ(X, C) = X 上所有连续函数
- 对结构层 O_X：Γ(X, O_X) = X 上整体正则函数
```

### 14.2.2 预层的嵌入

> **定义 14.2.2（层的嵌入）**
> 
> 对任何预层 P，存在**自然嵌入** P → P^{#}，其中 P^{#} 是其**层化**（最小的层）。

```text
这个嵌入在截面层面给出同态：
Γ(X, P) → Γ(X, P^{#})

但这不是同构！
- 整体预层截面 ≠ 整体层截面
- 这就是为什么需要上同调！
```

---

## 14.3 内射消解

### 14.3.1 内射模回顾

> **定义 14.3.1（内射模）**
> 
> R-模 I 是**内射的（Injective）**，如果函子 Hom_R(-, I) 是正合的。
> 
> 等价地：任何单态射 A → B 诱导出 Hom_R(B, I) → Hom_R(A, I) 是满态射。

```text
简单理解：
- 内射模 = 「在 Hom 函子下正合」
- 这类似于「分裂」的 Ext 函子
```

### 14.3.2 内射消解

> **定义 14.3.2（内射消解）**
> 
> 对任何 R-模 M，**内射消解**是一个正合列：
> 
> ```
> 0 → M → I⁰ → I¹ → I² → ...
> ```
> 
> 其中每个 I^j 是内射模。

```text
例子：
- 任何模都有内射消解（Bourbaki）
- 消解给出了「打包」模的方式
- 导出函子就从这里来！
```

### 14.3.3 预层的消解

> **定义 14.3.3（层的消解）**
> 
> 对层 F，类似地可以构造层的消解：
> 
> ```
> 0 → F → C⁰ → C¹ → C² → ...
> ```
> 
> 其中 C^j 是层（通常取为「Godement 消解」）。

---

## 14.4 层上同调的定义

### 14.4.1 导出函子

> **定义 14.4.1（层上同调）**
> 
> 设 X 是拓扑空间，F 是 X 上的阿贝尔层。**层上同调**定义为：
> 
> ```
> Hⁱ(X, F) = RⁱΓ(X, F)
> ```
> 
> 即全局截面函子 Γ(X, -) 的右导出函子。

```text
解释：
- Γ(X, -) 是正合的吗？不是！（局部→整体不保持正合）
- 正合性失败的地方 → 上同调群
- RⁱΓ = 导出函子 = 测量「失败的程度」
```

### 14.4.2 计算方法

> **定义 14.4.2（上同调的计算）**
> 
> 要计算 Hⁱ(X, F)：
> 1. 取 F 的消解 0 → F → I^*
> 2. 取整体截面 Γ(X, I^*)
> 3. 取上同调群：Hⁱ(X, F) = Hⁱ(Γ(X, I^*))

```text
步骤：
1. F → I⁰ → I¹ → I² → ... （消解）
2. 0 → Γ(X, I⁰) → Γ(X, I¹) → Γ(X, I²) → ... （取截面）
3. 取上同调：Ker / Im = Hⁱ
```

---

## 14.5 Čech 上同调

### 14.5.1 Čech 复形的定义

> **定义 14.5.1（Čech 上同调）**
> 
> 给定开覆盖 U = {U_i}，**Čech 复形**是：
> 
> ```
> Č^p(U, F) = ∏_{i₀<...<i_p} F(U_{i₀} ∩ ... ∩ U_{i_p})
> ```
> 
> 微分 d: Č^p → Č^{p+1} 由交替和给出。

```text
直观理解：
- Č⁰：单个开集上的截面
- Č¹：两个开集交上的「不一致性」
- Č²：三个开集交上的「更高阶不一致性」

这些「不一致性」的集合就是上同调！
```

### 14.5.2 Čech 上同调的计算

> **定义 14.5.2（Čech 上同调群）**
> 
> **Čech 上同调**定义为：
> 
> ```
> Ȟ^p(U, F) = H^p(Č^*(U, F))
> ```

### 14.5.3 定理：Čech 上同调 ≅ 层上同调

> **定理 14.5.3（ Leray 定理）**
> 
> 如果开覆盖是**良好覆盖**（所有有限交都是开集且层在其上松弛），则：
> 
> ```
> Ȟ^p(U, F) ≅ H^p(X, F)
> ```

```text
这给出了计算层上同调的实际方法！
```

---

## 14.6 射影空间的层上同调

### 14.6.1 射影空间的上同调计算

> **定理 14.6.1（P¹ 的上同调）**
> 
> 对射影直线 P¹ = Proj k[t₀, t₁]：
> 
> ```
> H⁰(P¹, O(d)) = k[t₀, t₁]_d （d 次齐次元）
> H¹(P¹, O(d)) = 0 （对所有 d）
> H¹(P¹, O(-2)) = k（Serre 对偶）
> ```

```text
几何意义：
- O(1) 的截面 = 线性多项式
- O(2) 的截面 = 二次型
- ...
- 对 d ≥ 0，H¹ = 0
- 这说明 P¹ 是「仿射的」从某些角度看！
```

### 14.6.2 射影空间的上同调一般公式

> **定理 14.6.2（Pⁿ 的上同调）**
> 
> 对射影空间 Pⁿ：
> 
> ```
> Hⁱ(Pⁿ, O(d)) = 
>   - k[t₀,...,tₙ]_d，如果 i = 0
>   - k[t₀,...,tₙ]_{-d-(n+1)}，如果 i = n
>   - 0，其他 i
> ```
> 
> 其中 k[t]_d 表示 d 次齐次元。

```text
例子：对 P²
- H⁰(O(d)) = d 次齐次多项式
- H²(O(d)) = d 次齐次多项式（Serre 对偶）
- H¹(O(d)) = 0
```

---

## 14.7 层的正合性与 Tor

### 14.7.1 层的正合性

> **定义 14.7.1（正合列）**
> 
> 层的短正合列：
> 
> ```
> 0 → F' → F → F'' → 0
> ```
> 
> 诱导出**长上同调正合列**：
> 
> ```
> 0 → H⁰(F') → H⁰(F) → H⁰(F'') → H¹(F') → H¹(F) → ...
> ```

```text
几何直觉：
- H⁰ 可以不是正合的
- H¹ 测量「偏差」
- 偏差可以传播！
```

### 14.7.2 Tor 函子

> **定义 14.7.2（Tor 函子）**
> 
> **Tor_i^R(M, N)** 是 M ⊗_R N 的左导出函子：
> 
> ```
> Tor_i^R(M, N) = H_i(M ⊗_R P^*)
> ```
> 
> 其中 P_* → M 是 M 的投射消解。

```text
例子：
- Tor_1^ℤ(ℤ/m, ℤ/n) = ℤ/gcd(m,n)
- 这给出了模之间的「偏差」测量
```

---

## 14.8 Serre 对偶

### 14.8.1 对偶定理

> **定理 14.8.1（Serre 对偶）**
> 
> 对射影簇 X（光滑，n 维）：
> 
> ```
> Hⁱ(X, F) ≅ H^{n-i}(X, F ⊗ ω_X)^∨
> ```
> 
> 其中 ω_X 是**典范层**（双层对偶层）。

```text
例子：P¹ 的 Serre 对偶
- ω_{P¹} = O(-2)
- H⁰(P¹, O(d)) ≅ H¹(P¹, O(d-2))^∨
- 这给出了对偶！
```

### 14.8.2 几何意义

```text
几何直觉：
- H⁰：整体截面
- Hⁿ：对偶 → 整体截面
- 正交：「在另一半」
- Serre 对偶把「左」和「右」配对！
```

---

## 14.9 应用：Riemann-Roch 定理

### 14.9.1 曲线的 Riemann-Roch

> **定理 14.9.1（Riemann-Roch for Curves）**
> 
> 对光滑曲线 C 上的除子 D：
> 
> ```
> l(D) - l(K - D) = deg(D) - g + 1
> ```
> 
> 其中：
> - l(D) = H⁰(C, O(D)) 的维数
> - K 是典范除子
> - g 是亏格

```text
几何意义：
- 左边：截面数 - 对偶截面数
- 右边：度数 - 亏格 + 1
- 这给出了曲线上的「计数公式」！
```

### 14.9.2 应用例子

```text
例子：计算直线丛的截面
- D = dP（P 是点）
- l(dP) = d - g + 1（如果 d ≥ 2g - 1）

这在椭圆曲线中尤其重要！
```

---

## 14.10 进一步的主题

### 14.10.1 平展上同调

> **平展上同调（Étale Cohomology）** 是：
> - 代数几何中的「拓扑」上同调
> - 可以比较不同域上的几何
> - Weil 猜想的基础！

### 14.10.2 Crystal Cohomology

> **结晶上同调**是：
> - p-进几何中的上同调
> - 研究特征 p 几何的工

---

## 14.11 习题

### 基础题

1. 计算：P¹ 上 O(0), O(1), O(2) 的整体截面

2. 验证：Čech 上同调对良好覆盖给出正确的 H¹

3. 描述：如何用上同调测量「不能粘起来」的障碍

### 进阶题

4. 证明：射影空间的层上同调满足 Serre 对偶

5. 应用 Riemann-Roch：计算椭圆曲线的截面数

6. 描述：如何用上同调研究曲线族

### 挑战题

7. **探索**：
   - 阅读「导出品范畴」D(X)
   - 思考：为什么导出范畴比层范畴「更好」？

---

## 本章小结

| 概念 | 定义 | 直观理解 |
|------|------|----------|
| 层上同调 | 导出函子 RⁱΓ | 局部→整体的障碍 |
| H⁰ | 整体截面 | 直接能看到的截面 |
| H¹ | 粘合障碍 | 局部截面粘成整体的困难 |
| Čech上同调 | 用开覆盖计算 | 交叠处的「不一致」 |
| Tor | M⊗N的导出 | 张量积的正合性偏差 |
| Serre对偶 | Hⁱ ≅ H^{n-i}∨ | 维数对偶 |
| Riemann-Roch | l(D)-l(K-D) | 曲线上的计数公式 |

---

## 代数几何伏笔

> 这一章学的上同调，是现代代数几何的核心工具！
> 
> - **层上同调** = 研究整体性质
> - **Serre对偶** = 维数对偶
> - **Riemann-Roch** = 曲线/曲面的计数
> - **平展上同调** = 特征 p 几何
> 
> 继续学习曲线论和椭圆曲线！

---

## 下一步

接下来我们可以学习：
- 曲线论
- 椭圆曲线
- Abel 簇初步

---

*练习答案见附录*

# 第十二章：概形理论 —— 从局部到整体

> **本章导读**：概形（Scheme）是现代代数几何的核心对象。从「局部是仿射概形」这个简单思想出发，我们可以构建出丰富多彩的几何世界。这一章会非常详细地介绍概形的定义，因为这是理解现代代数几何的关键。

---

## 12.1 动机：为什么要发明概形？

### 12.1.1 仿射簇的局限（详细解释）

在上一章中，我们学习了仿射簇和仿射概形。现在我们要问：**仿射簇有什么不够的地方？**

**问题1：非约化结构**
```text
例子：考虑集合 {0}，但带有「非零的平方为零」的结构

在仿射簇中，坐标环是 k[x]/(x²) 这样的环
- 作为点集，它只有一个点
- 但作为「几何」，它有一个「无穷小方向」

仿射簇（variety）只考虑约化环（没有幂零元）
- 这丢失了很多信息！
- 概形（scheme）可以包含非约化结构
```

**问题2：参数空间不存在**
```text
例子：所有 n 次多项式组成的「空间」在哪里？

- n+1 个系数 → A^{n+1} 中的点
- 但「重根」的多项式形成了一个「病态」的子集
- 用簇的语言很难描述这个「参数空间」
- 用概形的语言就很简单！
```

**问题3：所有点都是「闭点」吗？**
```text
在仿射簇中：
- 闭点 = 极大理想
- 但还有「非闭点」= 素理想 ≠ 极大理想

这在函数域的研究中很重要！
```

### 12.1.2 解决方案：概形

> **核心思想**：把「仿射概形」局部地「粘」起来！

> **定义 12.1.1（概形的直观思想）**
> 
> **概形（Scheme）** 是一个局部「看起来像」仿射概形的拓扑空间 equipped with a sheaf of rings。
> 
> 换句话说：**概形 = 仿射概形「粘」起来的大家伙！**

---

## 12.2 局部环空间的定义

### 12.2.1 局部环空间的正式定义

> **定义 12.2.1（局部环空间）**
> 
> **局部环空间（Locally Ringed Space）** 是一个配对 (X, O_X)，其中：
> 
> 1. **X** 是一个拓扑空间
> 2. **O_X** 是 X 上的**交换层环**（sheaf of commutative rings）
> 3. 对每个点 x ∈ X，茎 O_{X,x} 是一个**局部环**（有唯一极大理想）

```text
为什么要局部环？
- 这保证了在每个点「附近」我们有「局部坐标」
- 这与微积分中的「局部坐标」思想一致！
```

### 12.2.2 局部环空间的例子

```text
例子1：微分流形
- X = 光滑流形
- O_X = 光滑函数层
- 在每点，O_{X,x} = 「在该点附近定义的光滑函数环」
- 这是局部环！（极大理想 = 在该点为零的函数）

例子2：复流形
- X = 复流形
- O_X = 全纯函数层
- O_{X,x} = 全纯函数芽环

例子3：拓扑空间
- X = 任何拓扑空间
- O_X = 常数层 ℤ
- O_{X,x} = ℤ（这是局部环吗？——不！这不是局部环！）

💡 重要：概形是特殊的局部环空间！
```

---

## 12.3 概形的定义

### 12.3.1 概形的正式定义

> **定义 12.3.1（概形）**
> 
> **概形（Scheme）** 是一个局部环空间 (X, O_X)，满足：
> 
> **局部性条件**：对每个点 x ∈ X，存在开邻域 U，使得 (U, O_X|_U) 同构于一个仿射概形。
> 
> 换句话说：概形局部同构于 Spec R（某个环 R 的谱）。

```text
形式化表达：
X 是概形 ⇔ 存在开覆盖 {U_i}，使得
每个 (U_i, O_X|_{U_i}) ≅ Spec R_i（作为局部环空间）

这就像「用仿射概形片片粘起来」！
```

### 12.3.2 为什么这个定义强大？

```text
这个定义的威力：
1. 局部是仿射 → 我们可以用环论来处理局部问题
2. 整体是粘起来 → 我们可以研究整体性质
3. 可以处理非约化 → 比簇更灵活
4. 可以处理「病态」对象 → 适用范围更广
```

### 12.3.3 概形的例子

```text
例子1：仿射概形
- 任何 Spec R 都是概形
- 这是最基础的例子！

例子2：射影概形
- Pⁿ = Proj k[x₀, x₁, ..., xₙ]
- 这是概形！
- 它不是仿射的（当 n > 0 时）

例子3：两个仿射概形的并
- Spec k[x] ∪ Spec k[y] = 两条仿射直线的「并」
- 作为概形，这可以是一个整体！

例子4：带有结构的点
- Spec k[x]/(x²) 作为一个概形
- 记住「非约化信息」
```

---

## 12.4 概形的构造：粘合

### 12.4.1 粘合的思想

> **核心思想**：如果我们已经有了一些仿射概形 Spec R_i，以及它们之间的开嵌入，我们就可以把它们「粘」成一个更大的概形！

```text
这就像：
- 用小的纸片（仿射概形）
- 通过重叠部分（开集）
- 粘成一个大的图形（概形）
```

### 12.4.2 粘合的正式定义

> **定义 12.4.1（概形的粘合）**
> 
> 给定：
> - 一族仿射概形 {Spec R_i}
> - 对每对 i, j，开集 U_{ij} ⊆ Spec R_i
> - 同构 φ_{ij}: U_{ij} → U_{ji}（满足相容条件）
> 
> 可以唯一地构造一个概形 X，以及开浸入 Spec R_i → X，使得这些条件满足。

```text
相容条件（要满足三个）：
1. φ_{ii} = id（自身对应）
2. φ_{ij} = φ_{ji}^{-1}（反向对应）
3. φ_{ij}(U_{ij} ∩ U_{ik}) = U_{ji} ∩ U_{jk}
   并且 φ_{ij} ∘ φ_{jk} = φ_{ik}（传递性）
```

### 12.4.3 粘合的例子

```text
例子：射影直线 P¹ 是如何粘起来的？

P¹ 可以看作两个仿射直线的并：
- U₀ = Spec k[x] （对应 x₀/x₁ 中的 x = x₀/x₁ ≠ 0）
- U₁ = Spec k[y] （对应 x₁/x₀ 中的 y = x₁/x₀ ≠ 0）

重叠部分：
- U₀ ∩ U₁ = D(x) ∪ D(y) 在哪里？

实际上，更好的理解是：
- U₀ = {x₀ ≠ 0} ≅ Spec k[x₁/x₀] = Spec k[x]
- U₁ = {x₁ ≠ 0} ≅ Spec k[x₀/x₁] = Spec k[y]

重叠：U₀ ∩ U₁ ≅ Spec k[x, y]/(xy - 1) ≅ k[x, x⁻¹]
```

---

## 12.5 概形的态射

### 12.5.1 态射的定义

> **定义 12.5.1（概形的态射）**
> 
> 概形之间的**态射（Morphism）** f: X → Y 是局部环空间的态射：
> 
> 1. 连续映射 f: |X| → |Y|
> 2. 层的拉回映射 f^*: O_Y → f_* O_X
> 
> 使得在每个点局部地：
> - f 的茎是局部环的局部同态

```text
更具体地：
- 对每个开集 V ⊆ Y，f^* 给出 O_Y(V) → O_X(f^{-1}(V))
- 在茎层面：f^*_x: O_{Y, f(x)} → O_{X, x} 是局部环同态
  （即把极大理想拉回到极大理想）
```

### 12.5.2 态射的例子

```text
例子1：开浸入
- U ⊆ X 开子集
- i: U → X 是包含映射
- 这是态射！

例子2：闭浸入
- Z ⊆ X 是闭子概形
- i: Z → X 是包含
- 这也是态射！

例子3：仿射态射
- f: Spec B → Spec A 来自环同态 φ: A → B
- 这是最基础的态射！

例子4：结构态射
- X → Spec ℤ（对任何概形 X）
- 给出 X 的「基环」
```

### 12.5.3 态射的性质

> **定义 12.5.2（态射的性质）**
> 
> 态射可以有很多重要性质：

| 性质 | 定义 | 直观理解 |
|------|------|----------|
| **单态射** | 函子性地 | 像「子对象」 |
| **满态射** | 函子性地 | 像「商对象」 |
| **等距浸入** | 局部闭浸入 | 「嵌入」 |
| **平展态射** | 局部自由 | 「参数族」 |
| **有限态射** | 有限生成代数 | 「覆盖」 |
| **有限型态射** | 局部有限型 | 「代数簇」 |

---

## 12.6 纤维积

### 12.6.1 纤维积的动机

> **问题**：在概形理论中，给定态射 X → S 和 Y → S，**「X 和 Y 在 S 上纤维积」**是什么？

```text
几何直觉：
- 就像「笛卡尔积」加上「基底 S」的条件
- X ×_S Y = { (x, y) | f(x) = g(y) }

在集合层面：
- X ×_S Y = { (x, y) ∈ X × Y | f(x) = g(y) }
```

### 12.6.2 纤维积的定义

> **定义 12.6.1（纤维积/拉回）**
> 
> **纤维积（Fiber Product）** X ×_S Y 加上投影态射：
> - π_X: X ×_S Y → X
> - π_Y: X ×_S Y → Y
> 
> 满足以下**泛性质**：
> 
> 对任何概形 Z 和态射 Z → X, Z → Y，使得图表
> ```
>     Z
>    / \
>   /   \
>  X → Y
>   ↘
>    S
> ```
> 交换，唯一地存在态射 Z → X ×_S Y 使得图表交换。

```text
形式化：
Hom_Z(Z, X ×_S Y) ≅ { (φ: Z → X, ψ: Z → Y) | f∘φ = g∘ψ }
```

### 12.6.3 纤维积的例子

```text
例子1：仿射情况
- Spec B ×_Spec A Spec C ≅ Spec (B ⊗_A C)
- 纤维积在仿射情况就是「张量积」！

例子2：基扩张
- X ×_{Spec ℤ} Spec k ≅ X_k
- 这是「把基环扩展到 k」

例子3： Cartesian 图
- 任何 Cartesian 图表都可以在概形范畴中构造！
```

---

## 12.7 分离态射与紧致性

### 12.7.1 对角态射

> **定义 12.7.1（对角态射）**
> 
> 给定态射 f: X → Y，**对角态射** Δ: X → X ×_Y X 是唯一使得以下图表交换的态射：
> 
> ```
> X
> │ \
> │  \
> ▼   ▼
> X×Y X → Y
> ```

### 12.7.2 分离态射

> **定义 12.7.2（分离态射）**
> 
> 态射 f: X → Y 是**分离的（Separated）**，如果对角态射是闭浸入。
> 
> 换句话说：X → Y 是分离的 ⇔ X 可以被 Y 上的「开集」分开。

```text
为什么这很重要？
- 分离 = 「没有「非预期的」自交」
- 就像拓扑中的 Hausdorff 性质！
- 任何「合理」的代数簇都是分离的
```

### 12.7.3 紧致性

> **定义 12.7.3（紧致）**
> 
> 概形 X 是**紧致（Proper）**的，如果它：
> 1. 有限型
> 2. 分离
> 3. 泛闭（任何态射 Z → X，闭浸入的像是闭的）

```text
几何直觉：
- Proper = 「紧致 + 边界行为好」
- 射影簇都是 proper！
- 这类似于拓扑中的紧致性
```

---

## 12.8 有限型态射

### 12.8.1 有限生成代数回顾

> **定义 12.8.1（有限生成代数）**
> 
> A-代数 B 是**有限生成的（Finite Type）**，如果存在有限生成：
> 
> ```
> B ≅ A[x₁, ..., xₙ] / I
> ```
> 
> 即 B 作为 A-代数可以由 n 个元素生成。

### 12.8.2 有限型态射

> **定义 12.8.2（有限型态射）**
> 
> 态射 f: X → Y 是**有限型的（Finite Type）**，如果：
> - 局部地，X 可以被仿射开集覆盖 Spec B
> - Y 被仿射开集覆盖 Spec A
> - 使得 B 是有限生成的 A-代数

```text
几何直觉：
- 有限型 = 「局部是有限维的」
- 这确保了「维数」是良好定义的！
- 代数簇 → 有限型概形！
```

---

## 12.9 簇的定义

### 12.9.1 簇

> **定义 12.9.1（代数簇/簇）**
> 
> **簇（Variety）** 是：
> 1. 分离（separated）
> 2. 有限型（finite type）
> 3. 在某个基域 k 上
> 
> 的概形。

```text
例子：
- 仿射簇：Spec k[V]
- 射影簇：Proj k[V]
- 拟射影簇：开子簇

簇 = 「好的」代数几何对象！
```

### 12.9.2 簇的例子

```text
例子1：仿射簇
- Spec k[x] = A¹
- Spec k[x, y]/(y² - x³) = 尖点抛物线

例子2：射影簇
- Pⁿ = Proj k[x₀, ..., xₙ]
- 椭圆曲线：y²z = x³ + axz² + bz³

例子3：消费簇
- 开子集 ⊂ 射影簇
```

---

## 12.10 习题

### 基础题

1. 证明：任何仿射概形都是概形

2. 描述：如何把两条仿射直线粘成 P¹

3. 验证：Spec R ×_{Spec ℤ} Spec S ≅ Spec (R ⊗_ℤ S)

### 进阶题

4. 证明：开浸入是分离态射

5. 描述：如何用纤维积构造「椭圆曲线的模」

6. 验证：射影空间 Pⁿ 是 proper 的

### 挑战题

7. **探索**：
   - 阅读「Grothendieck 概形」的思想
   - 思考：概形理论为什么能统一数论和几何？

---

## 本章小结

| 概念 | 定义 | 直观理解 |
|------|------|----------|
| 局部环空间 | 茎都是局部环的空间 | 每个点有局部坐标 |
| 概形 | 局部同构于仿射概形 | 仿射片粘起来的大空间 |
| 粘合 | 用开集粘出概形 | 像贴纸一样 |
| 态射 | 局部环空间的映射 | 保持结构的映射 |
| 纤维积 | X×_S Y = {(x,y)|f(x)=g(y)} | 笛卡尔积的版本 |
| 分离 | 对角闭浸入 | 没有自交 |
| 紧致/Proper | 分离+有限型+泛闭 | 紧致+好边界 |
| 有限型 | 局部有限生成代数 | 局部有限维 |
| 簇 | 分离+有限型+基域k | 经典代数几何对象 |

---

## 代数几何伏笔

> 这一章学的概形理论，是现代代数几何的基石！
> 
> - **簇** = 有限型概形
> - **射影簇** = 射影空间中的簇
> - **阿贝尔簇** = 带有群结构的簇
> - **模堆** = 概形的「族」
> 
> 下一章我们将学习**射影几何**——研究射影空间中的几何！

---

## 下一步

下一章我们将学习**射影空间与射影簇**——经典代数几何的核心！

准备好了吗？🚀

---

*练习答案见附录*
